{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block title %} {{ user_to_show.get_full_name }} {% endblock %}

{% block scripts %}
    <script src="{{ STATIC_URL }}jquery.stickytableheaders.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $(".table_tasks").tablesorter();
            $(".table_tasks").stickyTableHeaders({fixedOffset: $('.navbar')});
        });
    </script>

{% endblock %}

{% block navbar %}
    <ul class="nav navbar-nav">
        <li class="nav-item">
            <a class="nav-link" href="{% url users.views.profile %}">Профиль</a>
        </li>
        <li class="nav-item">
            <a class="nav-link active" href="">Мои задачи</a>
        </li>
    </ul>
{% endblock navbar %}

{% block content %}

    <style>
        .table_tasks th {
            white-space: nowrap
        }
    </style>

    <div class="card">
        <div class="card-block">
            <h3 class="card-title">Мои задачи</h3>
            {% if issues %}
                <table class="table table_tasks">
                    <thead>
                    <tr style="background-color: #ffffff;">
                        <th>Задача<i class="fa fa-fw fa-sort"></i></th>
                        <th>Курс<i class="fa fa-fw fa-sort"></i></th>
                        <th>Обновлена<i class="fa fa-fw fa-sort"></i></th>
                        <th>Статус<i class="fa fa-fw fa-sort"></i></th>
                        <th>Оценка<i class="fa fa-fw fa-sort"></i></th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for issue in issues %}
                        <tr onclick="location.href='{% if issue.task.has_issue_access %}{{ issue.get_absolute_url }}{% else %}#{% endif %}'">
                            <td>
                                {% if issue.task.has_issue_access %}
                                    <a href="{{ issue.get_absolute_url }}">{{ issue.task }}</a>
                                {% else %}
                                    {{ issue.task }}
                                {% endif %}
                            </td>
                            <td><a href="{{ issue.task.course.get_absolute_url }}">{{ issue.task.course }}</a></td>
                            <td><i class="fa fa-clock-o fa-flip-horizontal"></i> {{ issue.update_time|date:"d M H:i" }} </td>
                            <td> {{ issue.get_status }} </td>
                            <td> {{ issue.score }} </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p class="card-text">Вы не сдавали ни одной задачи</p>
            {% endif %}
        </div>
    </div>
{% endblock %}
